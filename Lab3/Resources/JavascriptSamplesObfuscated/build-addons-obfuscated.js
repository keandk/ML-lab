var _0x27e1=['map','all','catch','child_process','promises','util','execFile','env','JOBS','cpus','length','stat','join','binding.gyp','code','ENOENT','ENOTDIR','execPath','rebuild','--directory=','inherit','stdout','write','stderr','readdir'];(function(_0x2ee206,_0x3b6aa4){var _0x4038d3=function(_0x2cbad0){while(--_0x2cbad0){_0x2ee206['push'](_0x2ee206['shift']());}};_0x4038d3(++_0x3b6aa4);}(_0x27e1,0x80));var _0x2732=function(_0x4f8b39,_0x532730){_0x4f8b39=_0x4f8b39-0x0;var _0x36aeaf=_0x27e1[_0x4f8b39];return _0x36aeaf;};'use strict';// Usage: e.g. node build-addons.js <path to node-gyp> <directory>
const child_process=require(_0x2732('0x0'));const path=require('path');const fs=require('fs')[_0x2732('0x1')];const util=require(_0x2732('0x2'));const execFile=util['promisify'](child_process[_0x2732('0x3')]);const parallelization=+process[_0x2732('0x4')][_0x2732('0x5')]||require('os')[_0x2732('0x6')]()['length'];const nodeGyp=process['argv'][0x2];async function runner(_0x1bb74c){if(_0x1bb74c[_0x2732('0x7')]===0x0)return;const _0x236bdc=_0x1bb74c['shift']();const _0x5a12b6=()=>runner(_0x1bb74c);try{await fs[_0x2732('0x8')](path[_0x2732('0x9')](_0x236bdc,_0x2732('0xa')));}catch(_0x117e36){if(_0x117e36[_0x2732('0xb')]===_0x2732('0xc')||_0x117e36[_0x2732('0xb')]===_0x2732('0xd'))return _0x5a12b6();throw _0x117e36;}console['log']('Building\x20addon\x20in\x20'+_0x236bdc);const {stdout,stderr}=await execFile(process[_0x2732('0xe')],[nodeGyp,_0x2732('0xf'),_0x2732('0x10')+_0x236bdc],{'stdio':_0x2732('0x11'),'env':{...process['env'],'MAKEFLAGS':'-j1'}});process[_0x2732('0x12')][_0x2732('0x13')](stdout);process[_0x2732('0x14')][_0x2732('0x13')](stderr);return _0x5a12b6();}async function main(_0x5512e1){const _0x36f7a1=(await fs[_0x2732('0x15')](_0x5512e1))[_0x2732('0x16')](_0x41055d=>path[_0x2732('0x9')](_0x5512e1,_0x41055d));const _0x304c3a=[];for(let _0x38d3b6=0x0;_0x38d3b6<parallelization;++_0x38d3b6)_0x304c3a['push'](runner(_0x36f7a1));return Promise[_0x2732('0x17')](_0x304c3a);}main(process['argv'][0x3])[_0x2732('0x18')](_0xd8ab27=>setImmediate(()=>{throw _0xd8ab27;}));