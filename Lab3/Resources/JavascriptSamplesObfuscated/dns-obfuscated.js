var _0x3de3=['cls','TXT','byteLength','Unknown\x20RR\x20type\x20','byteOffset','swap16','swap32','ENOTFOUND','getaddrinfo','errno','syscall','exports','toString','ascii','strictEqual','readUInt16BE','length','questions','answers','type','ttl','readInt32BE','address','AAAA','$1:','entries','push','priority','readInt16BE','exchange','CNAME','PTR','value','SOA','nread','nsname','domain','hostmaster','serial','readUInt32BE','refresh','retry','expire','minttl','split','alloc','writeUInt16BE','concat','from','flags','authorityAnswers','additionalRecords'];(function(_0xa3fea0,_0x474340){var _0x25b2af=function(_0x312580){while(--_0x312580){_0xa3fea0['push'](_0xa3fea0['shift']());}};_0x25b2af(++_0x474340);}(_0x3de3,0x110));var _0x3819=function(_0xb118db,_0x44ff94){_0xb118db=_0xb118db-0x0;var _0x581c8b=_0x3de3[_0xb118db];return _0x581c8b;};/* eslint-disable node-core/required-modules */
'use strict';const assert=require('assert');const os=require('os');const types={'A':0x1,'AAAA':0x1c,'NS':0x2,'CNAME':0x5,'SOA':0x6,'PTR':0xc,'MX':0xf,'TXT':0x10,'ANY':0xff};const classes={'IN':0x1};function readDomainFromPacket(_0x3516da,_0x109a7c){assert['ok'](_0x109a7c<_0x3516da['length']);const _0x278a69=_0x3516da[_0x109a7c];if(_0x278a69===0x0){return{'nread':0x1,'domain':''};}else if((_0x278a69&0xc0)===0x0){_0x109a7c+=0x1;const _0x289420=_0x3516da[_0x3819('0x0')](_0x3819('0x1'),_0x109a7c,_0x109a7c+_0x278a69);const {nread,domain}=readDomainFromPacket(_0x3516da,_0x109a7c+_0x278a69);return{'nread':0x1+_0x278a69+nread,'domain':domain?_0x289420+'.'+domain:_0x289420};}else{assert[_0x3819('0x2')](_0x278a69&0xc0,0xc0);const _0x15873c=_0x3516da[_0x3819('0x3')](_0x109a7c)&~0xc000;return{'nread':0x2,'domain':readDomainFromPacket(_0x3516da,_0x15873c)};}}function parseDNSPacket(_0x5094dc){assert['ok'](_0x5094dc[_0x3819('0x4')]>0xc);const _0x485467={'id':_0x5094dc[_0x3819('0x3')](0x0),'flags':_0x5094dc[_0x3819('0x3')](0x2)};const _0x30ca26=[[_0x3819('0x5'),_0x5094dc['readUInt16BE'](0x4)],[_0x3819('0x6'),_0x5094dc[_0x3819('0x3')](0x6)],['authorityAnswers',_0x5094dc[_0x3819('0x3')](0x8)],['additionalRecords',_0x5094dc['readUInt16BE'](0xa)]];let _0x528db5=0xc;for(const [_0x37b479,_0x294932]of _0x30ca26){_0x485467[_0x37b479]=[];for(let _0xe8bea=0x0;_0xe8bea<_0x294932;++_0xe8bea){const {nread,domain}=readDomainFromPacket(_0x5094dc,_0x528db5);_0x528db5+=nread;const _0x2c47d9=_0x5094dc[_0x3819('0x3')](_0x528db5);const _0x2bd124={'domain':domain,'cls':_0x5094dc[_0x3819('0x3')](_0x528db5+0x2)};_0x528db5+=0x4;for(const _0x48e45c in types){if(types[_0x48e45c]===_0x2c47d9)_0x2bd124[_0x3819('0x7')]=_0x48e45c;}if(_0x37b479!==_0x3819('0x5')){_0x2bd124[_0x3819('0x8')]=_0x5094dc[_0x3819('0x9')](_0x528db5);const _0x5c9852=_0x5094dc[_0x3819('0x3')](_0x528db5);_0x528db5+=0x6;switch(_0x2c47d9){case types['A']:assert[_0x3819('0x2')](_0x5c9852,0x4);_0x2bd124[_0x3819('0xa')]=_0x5094dc[_0x528db5+0x0]+'.'+_0x5094dc[_0x528db5+0x1]+'.'+(_0x5094dc[_0x528db5+0x2]+'.'+_0x5094dc[_0x528db5+0x3]);break;case types[_0x3819('0xb')]:assert[_0x3819('0x2')](_0x5c9852,0x10);_0x2bd124[_0x3819('0xa')]=_0x5094dc[_0x3819('0x0')]('hex',_0x528db5,_0x528db5+0x10)['replace'](/(.{4}(?!$))/g,_0x3819('0xc'));break;case types['TXT']:{let _0x836470=_0x528db5;_0x2bd124[_0x3819('0xd')]=[];while(_0x836470<_0x528db5+_0x5c9852){const _0x1747d6=_0x5094dc[_0x528db5];_0x2bd124['entries'][_0x3819('0xe')](_0x5094dc[_0x3819('0x0')]('utf8',_0x836470+0x1,_0x836470+0x1+_0x1747d6));_0x836470+=0x1+_0x1747d6;}assert['strictEqual'](_0x836470,_0x528db5+_0x5c9852);break;}case types['MX']:{_0x2bd124[_0x3819('0xf')]=_0x5094dc[_0x3819('0x10')](_0x5094dc,_0x528db5);_0x528db5+=0x2;const {nread,domain}=readDomainFromPacket(_0x5094dc,_0x528db5);_0x2bd124[_0x3819('0x11')]=domain;assert[_0x3819('0x2')](nread,_0x5c9852);break;}case types['NS']:case types[_0x3819('0x12')]:case types[_0x3819('0x13')]:{const {nread,domain}=readDomainFromPacket(_0x5094dc,_0x528db5);_0x2bd124[_0x3819('0x14')]=domain;assert[_0x3819('0x2')](nread,_0x5c9852);break;}case types[_0x3819('0x15')]:{const _0x372504=readDomainFromPacket(_0x5094dc,_0x528db5);const _0x2b3b5a=readDomainFromPacket(_0x5094dc,_0x528db5+_0x372504[_0x3819('0x16')]);_0x2bd124[_0x3819('0x17')]=_0x372504[_0x3819('0x18')];_0x2bd124[_0x3819('0x19')]=_0x2b3b5a[_0x3819('0x18')];const _0x13c08f=_0x528db5+_0x372504[_0x3819('0x16')]+_0x2b3b5a[_0x3819('0x16')];_0x2bd124[_0x3819('0x1a')]=_0x5094dc[_0x3819('0x1b')](_0x13c08f);_0x2bd124[_0x3819('0x1c')]=_0x5094dc[_0x3819('0x1b')](_0x13c08f+0x4);_0x2bd124[_0x3819('0x1d')]=_0x5094dc[_0x3819('0x1b')](_0x13c08f+0x8);_0x2bd124[_0x3819('0x1e')]=_0x5094dc[_0x3819('0x1b')](_0x13c08f+0xc);_0x2bd124[_0x3819('0x1f')]=_0x5094dc[_0x3819('0x1b')](_0x13c08f+0x10);assert['strictEqual'](_0x13c08f+0x14,_0x5c9852);break;}default:throw new Error('Unknown\x20RR\x20type\x20'+_0x2bd124['type']);}_0x528db5+=_0x5c9852;}_0x485467[_0x37b479][_0x3819('0xe')](_0x2bd124);assert['ok'](_0x528db5<=_0x5094dc['length']);}}assert[_0x3819('0x2')](_0x528db5,_0x5094dc[_0x3819('0x4')]);return _0x485467;}function writeIPv6(_0x4233a0){const _0x6684cb=_0x4233a0['replace'](/^:|:$/g,'')[_0x3819('0x20')](':');const _0x95937d=Buffer[_0x3819('0x21')](0x10);let _0x55c7cb=0x0;for(const _0x5275f9 of _0x6684cb){if(_0x5275f9===''){_0x55c7cb+=0x10-0x2*(_0x6684cb[_0x3819('0x4')]-0x1);}else{_0x95937d[_0x3819('0x22')](parseInt(_0x5275f9,0x10),_0x55c7cb);_0x55c7cb+=0x2;}}return _0x95937d;}function writeDomainName(_0x3b6a7c){return Buffer[_0x3819('0x23')](_0x3b6a7c[_0x3819('0x20')]('.')['map'](_0x22df02=>{assert(_0x22df02['length']<0x40);return Buffer[_0x3819('0x23')]([Buffer[_0x3819('0x24')]([_0x22df02[_0x3819('0x4')]]),Buffer[_0x3819('0x24')](_0x22df02,'ascii')]);})[_0x3819('0x23')]([Buffer[_0x3819('0x21')](0x1)]));}function writeDNSPacket(_0x53675d){const _0x3106d7=[];const _0x2e758e=0x8180;_0x3106d7[_0x3819('0xe')](new Uint16Array([_0x53675d['id'],_0x53675d[_0x3819('0x25')]===undefined?_0x2e758e:_0x53675d[_0x3819('0x25')],_0x53675d[_0x3819('0x5')]&&_0x53675d[_0x3819('0x5')][_0x3819('0x4')],_0x53675d[_0x3819('0x6')]&&_0x53675d[_0x3819('0x6')]['length'],_0x53675d[_0x3819('0x26')]&&_0x53675d[_0x3819('0x26')][_0x3819('0x4')],_0x53675d[_0x3819('0x27')]&&_0x53675d[_0x3819('0x27')][_0x3819('0x4')]]));for(const _0x4ecf61 of _0x53675d[_0x3819('0x5')]){assert(types[_0x4ecf61[_0x3819('0x7')]]);_0x3106d7[_0x3819('0xe')](writeDomainName(_0x4ecf61[_0x3819('0x18')]));_0x3106d7[_0x3819('0xe')](new Uint16Array([types[_0x4ecf61['type']],_0x4ecf61[_0x3819('0x28')]===undefined?classes['IN']:_0x4ecf61[_0x3819('0x28')]]));}for(const _0x38fa1c of[][_0x3819('0x23')](_0x53675d[_0x3819('0x6')],_0x53675d['authorityAnswers'],_0x53675d[_0x3819('0x27')])){if(!_0x38fa1c)continue;assert(types[_0x38fa1c[_0x3819('0x7')]]);_0x3106d7[_0x3819('0xe')](writeDomainName(_0x38fa1c['domain']));_0x3106d7['push'](new Uint16Array([types[_0x38fa1c[_0x3819('0x7')]],_0x38fa1c[_0x3819('0x28')]===undefined?classes['IN']:_0x38fa1c[_0x3819('0x28')]]));_0x3106d7[_0x3819('0xe')](new Int32Array([_0x38fa1c[_0x3819('0x8')]]));const _0x458b24=new Uint16Array(0x1);_0x3106d7['push'](_0x458b24);switch(_0x38fa1c[_0x3819('0x7')]){case'A':_0x458b24[0x0]=0x4;_0x3106d7[_0x3819('0xe')](new Uint8Array(_0x38fa1c[_0x3819('0xa')][_0x3819('0x20')]('.')));break;case _0x3819('0xb'):_0x458b24[0x0]=0x10;_0x3106d7[_0x3819('0xe')](writeIPv6(_0x38fa1c['address']));break;case _0x3819('0x29'):const _0x26632e=_0x38fa1c[_0x3819('0xd')]['map'](_0x5a58f4=>_0x5a58f4[_0x3819('0x4')])['reduce']((_0x32ac9d,_0x398dfb)=>_0x32ac9d+_0x398dfb);_0x458b24[0x0]=_0x38fa1c[_0x3819('0xd')]['length']+_0x26632e;for(const _0x56c193 of _0x38fa1c[_0x3819('0xd')]){_0x3106d7[_0x3819('0xe')](new Uint8Array([Buffer[_0x3819('0x2a')](_0x56c193)]));_0x3106d7['push'](Buffer[_0x3819('0x24')](_0x56c193));}break;case'MX':_0x458b24[0x0]=0x2;_0x3106d7['push'](new Uint16Array([_0x38fa1c['priority']]));case'NS':case _0x3819('0x12'):case _0x3819('0x13'):{const _0x26e374=writeDomainName(_0x38fa1c[_0x3819('0x11')]||_0x38fa1c['value']);_0x458b24[0x0]+=_0x26e374[_0x3819('0x4')];_0x3106d7[_0x3819('0xe')](_0x26e374);break;}case _0x3819('0x15'):{const _0x5f5209=writeDomainName(_0x38fa1c[_0x3819('0x17')]);const _0x18f7f1=writeDomainName(_0x38fa1c[_0x3819('0x19')]);_0x458b24[0x0]=_0x5f5209[_0x3819('0x4')]+_0x18f7f1[_0x3819('0x4')]+0x14;_0x3106d7[_0x3819('0xe')](_0x5f5209,_0x18f7f1);_0x3106d7[_0x3819('0xe')](new Uint32Array([_0x38fa1c['serial'],_0x38fa1c[_0x3819('0x1c')],_0x38fa1c['retry'],_0x38fa1c[_0x3819('0x1e')],_0x38fa1c[_0x3819('0x1f')]]));break;}default:throw new Error(_0x3819('0x2b')+_0x38fa1c[_0x3819('0x7')]);}}return Buffer['concat'](_0x3106d7['map'](_0x1fdb17=>{const _0x210ad8=Buffer['from'](_0x1fdb17['buffer'],_0x1fdb17[_0x3819('0x2c')],_0x1fdb17[_0x3819('0x2a')]);if(os['endianness']()==='LE'){if(_0x1fdb17['BYTES_PER_ELEMENT']===0x2)_0x210ad8[_0x3819('0x2d')]();if(_0x1fdb17['BYTES_PER_ELEMENT']===0x4)_0x210ad8[_0x3819('0x2e')]();}return _0x210ad8;}));}const mockedErrorCode=_0x3819('0x2f');const mockedSysCall=_0x3819('0x30');function errorLookupMock(_0x5476fc=mockedErrorCode,_0x147ffb=mockedSysCall){return function lookupWithError(_0x24c445,_0x25a2ec,_0x203084){const _0x3d927a=new Error(_0x147ffb+'\x20'+_0x5476fc+'\x20'+_0x24c445);_0x3d927a['code']=_0x5476fc;_0x3d927a[_0x3819('0x31')]=_0x5476fc;_0x3d927a[_0x3819('0x32')]=_0x147ffb;_0x3d927a['hostname']=_0x24c445;_0x203084(_0x3d927a);};}module[_0x3819('0x33')]={'types':types,'classes':classes,'writeDNSPacket':writeDNSPacket,'parseDNSPacket':parseDNSPacket,'errorLookupMock':errorLookupMock,'mockedErrorCode':mockedErrorCode,'mockedSysCall':mockedSysCall};