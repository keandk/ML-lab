var _0x4459=['redirectTo','message','Oops!\x20Something\x20went\x20wrong.\x20Please\x20try\x20again\x20later','error','flash','function','redirectWithFlash','setHeader','Content-Type','application/json','send','errors','text/plain','env','production','status','type','html','json','text'];(function(_0x5e67c8,_0x188820){var _0x1b001f=function(_0x25899d){while(--_0x25899d){_0x5e67c8['push'](_0x5e67c8['shift']());}};_0x1b001f(++_0x188820);}(_0x4459,0x1c5));var _0xc232=function(_0x4557a8,_0x104e2b){_0x4557a8=_0x4557a8-0x0;var _0x57547e=_0x4459[_0x4557a8];return _0x57547e;};import _0x1dfa01 from'accepts';import{homeLocation}from'../../../config/env';import{unwrapHandledError}from'../utils/create-handled-error.js';const isDev=process[_0xc232('0x0')]['NODE_ENV']!==_0xc232('0x1');export default function prodErrorHandler(){return function(err,req,res,next){const handled=unwrapHandledError(err);let status=handled['status']||err[_0xc232('0x2')]||res['statusCode'];if(!handled['status']&&status<0x190){status=0x1f4;}res[_0xc232('0x2')](status);const accept=_0x1dfa01(req);const type=accept[_0xc232('0x3')](_0xc232('0x4'),_0xc232('0x5'),_0xc232('0x6'));const redirectTo=handled[_0xc232('0x7')]||homeLocation+'/';const message=handled[_0xc232('0x8')]||_0xc232('0x9');if(isDev){console[_0xc232('0xa')](err);}if(type===_0xc232('0x4')){if(typeof req[_0xc232('0xb')]===_0xc232('0xc')){req['flash'](handled['type']||'danger',message);}return res[_0xc232('0xd')](redirectTo);}else if(type==='json'){res[_0xc232('0xe')](_0xc232('0xf'),_0xc232('0x10'));return res[_0xc232('0x11')]({'type':handled[_0xc232('0x3')]||_0xc232('0x12'),'message':message});}else{res[_0xc232('0xe')](_0xc232('0xf'),_0xc232('0x13'));return res[_0xc232('0x11')](message);}};}